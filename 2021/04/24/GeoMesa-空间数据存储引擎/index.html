<!DOCTYPE html>
<html>
  
<head>
  <meta charset="utf-8">
  <meta name="author" content="Zhang Xueliang" />
  
  
  <title>GeoMesa空间数据存储引擎入门学习手册 | 学亮编程手记</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta name="keywords" content="GeoMesa," />
  

  
  <meta name="description" content="GeoMesa-空间数据存储引擎架构介绍及常见操作代码示例。">

  

  

  
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script>
  

  

  

  <script>
  // theme-ad's config script
  // it can be used in every script
  
  window.AD_CONFIG = {
    leancloud: {"appid":"Hyq9wkH495DgNHWhDQCOfQSp-gzGzoHsz","appkey":"WaR7nrzhliHj9aVwdQzkdlGd","comment":false,"count":false},
    welcome: {"enable":false,"interval":30},
    start_time: "2016-02-10",
    passwords: ["efe07af7441da2b69c4a41e42e73be4db47f66010a56900788a458354a7373ec", ],
    is_post: true,
    lock: false,
    author: "Zhang Xueliang",
    share: {"twitter":true,"facebook":true,"weibo":true,"qq":true,"wechat":true},
    mathjax: true,
    page_type: "",
    root: "/"
  };
</script>

  
<script src="/vendor/sha256.min.js"></script>
<script src="/js/auth.js"></script>
<script src="/js/index.js"></script>
<script src="/vendor/qrcode.min.js"></script>


  
    <link rel="icon" href="/images/favicon.ico">
    <link rel="apple-touch-icon" href="/images/touch-icon.png">
  

  <link href="//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

  
<link rel="stylesheet" href="/css/index.css">
<link rel="stylesheet" href="/styles/components/highlight/highlight.css">


  
<meta name="generator" content="Hexo 5.4.0"></head>
  <body>
    <header class="site-header">
  <div class="site-header-brand">
    
      <span class="site-header-brand-title">
        <a href="/">学亮编程手记</a>
      </span>
    
    
      <span class="site-header-brand-motto"> | 殚精竭虑，不如须臾之所学也！</span>
    
  </div>
  <div class="site-header-right">
    <nav class="site-header-navigation">
      
        <a href="/" target="_self">首页</a>
      
        <a href="/archives/" target="_self">归档</a>
      
    </nav>
    <div class="site-header-btn">
      
        <a href="https://github.com/xueliang666/" target="_blank" id="site-github">
          <i class="fa fa-github-alt"></i>
        </a>
      
      <a href="javascript:void(0);" id="site-search">
        <i class="fa fa-search"></i>
      </a>
      <a href="javascript:void(0);" id="site-nav-btn">
        <i class="fa fa-ellipsis-v"></i>
      </a>
    </div>
  </div>
</header>
<nav class="table-content" id="site-nav">
  <div class="table-content-title">
    <span>导航</span>
  </div>
  <div class="table-content-main">
    <ol class="toc">
      
        <li class="toc-item">
          <a href="/" target="_self">
            首页
          </a>
        </li>
      
        <li class="toc-item">
          <a href="/archives/" target="_self">
            归档
          </a>
        </li>
      
    </ol>
  </div>
</nav>
<div id="site-process"></div>
    <main>
      
  <div class="passage">
  <div class="passage-meta">
    <span>
      <i class="fa fa-calendar"></i>2021-04-24
    </span>
    
    
      <span>
        | <i class="fa fa-unlock-alt"></i>UNLOCK
      </span>
    
  </div>
  <h1 class="passage-title">
    GeoMesa空间数据存储引擎入门学习手册
  </h1>
  
  <article class="passage-article">
    <h1 id="GeoMesa-空间数据存储引擎"><a href="#GeoMesa-空间数据存储引擎" class="headerlink" title="GeoMesa-空间数据存储引擎"></a>GeoMesa-空间数据存储引擎</h1><p>geomesa简介、架构体系、数据存储、spark等</p>
<p><img src="https://img-blog.csdnimg.cn/20210429142644251.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2E3NzIzMDQ0MTk=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h2 id="第一部分：GeoMesa简介"><a href="#第一部分：GeoMesa简介" class="headerlink" title="第一部分：GeoMesa简介"></a><strong>第一部分：GeoMesa</strong>简介</h2><ul>
<li><p>GeoMesa是一款开源的基于分布式计算系统的⾯面向海海量量时空数据查询与分析的⼯工具包</p>
</li>
<li><p>GeoMesa基于GeoToolsAPI进⾏行行设计，与GeoServer等进⾏行行集成提供OGC标准的服务。</p>
</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/2021042914272655.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2E3NzIzMDQ0MTk=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<ul>
<li>⽀支持多种可扩展的、基于云端的数据存储架构，包括ApacheAccumulo,HBase，Cassandra，Google Bigtable，以及⽤用于流计算的Apache Kafka 。</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20210429142752273.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2E3NzIzMDQ0MTk=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<ul>
<li><p>提供了了Spark，并增加了了正对空间数据的UDT、UDF和UDAF，⽅方便便⽤用户直接使⽤用SparkSQL进⾏行行空间数据查询与分析。</p>
</li>
<li><p>Git 地址：<a target="_blank" rel="noopener" href="https://github.com/locationtech/geomesa%E3%80%82">https://github.com/locationtech/geomesa。</a></p>
</li>
<li><p>Build地址：<a target="_blank" rel="noopener" href="https://github.com/locationtech/geomesa/releases">https://github.com/locationtech/geomesa/releases</a></p>
</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20210429142820413.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2E3NzIzMDQ0MTk=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h2 id="第二部分：GeoMesa架构体系"><a href="#第二部分：GeoMesa架构体系" class="headerlink" title="第二部分：GeoMesa架构体系"></a><strong>第二部分：GeoMesa</strong>架构体系</h2><h3 id="1：模块划分"><a href="#1：模块划分" class="headerlink" title="1：模块划分"></a>1：模块划分</h3><p><img src="https://img-blog.csdnimg.cn/20210429142840278.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2E3NzIzMDQ0MTk=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<ul>
<li><h4 id="接口层"><a href="#接口层" class="headerlink" title="接口层"></a><strong>接口层</strong></h4><ul>
<li><a target="_blank" rel="noopener" href="https://www.geomesa.org/documentation/user/datastores/attributes.html">6.1. GeoTools Feature Types</a></li>
<li><a target="_blank" rel="noopener" href="https://www.geomesa.org/documentation/user/datastores/index_overview.html">6.2. Index Overview</a></li>
<li><a target="_blank" rel="noopener" href="https://www.geomesa.org/documentation/user/datastores/index_basics.html">6.3. Index Basics</a></li>
<li><a target="_blank" rel="noopener" href="https://www.geomesa.org/documentation/user/datastores/index_basics.html#index-versioning">6.4. Index Versioning</a></li>
<li><a target="_blank" rel="noopener" href="https://www.geomesa.org/documentation/user/datastores/index_config.html">6.5. Index Configuration</a></li>
<li><a target="_blank" rel="noopener" href="https://www.geomesa.org/documentation/user/datastores/runtime_config.html">6.6. Runtime Configuration</a></li>
<li><a target="_blank" rel="noopener" href="https://www.geomesa.org/documentation/user/datastores/query_planning.html">6.7. Query Planning</a></li>
<li><a target="_blank" rel="noopener" href="https://www.geomesa.org/documentation/user/datastores/query_planning.html#explaining-query-plans">6.8. Explaining Query Plans</a></li>
<li><a target="_blank" rel="noopener" href="https://www.geomesa.org/documentation/user/datastores/query_config.html">6.9. Query Properties</a></li>
<li><a target="_blank" rel="noopener" href="https://www.geomesa.org/documentation/user/datastores/filter_functions.html">6.10. Filter Functions</a></li>
<li><a target="_blank" rel="noopener" href="https://www.geomesa.org/documentation/user/datastores/analytic_queries.html">6.11. Analytic Querying</a></li>
<li><a target="_blank" rel="noopener" href="https://www.geomesa.org/documentation/user/datastores/authorizations.html">6.12. Authorizations</a></li>
<li><a target="_blank" rel="noopener" href="https://www.geomesa.org/documentation/user/datastores/auditing.html">6.13. Query Auditing</a></li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.geomesa.org/documentation/user/datastores/data.html">6.14. Moving and Migrating Data</a></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.geomesa.org/documentation/user/datastores/reserved_words.html">6.15. Reserved Words</a></li>
</ul>
</li>
<li><h4 id="命令行"><a href="#命令行" class="headerlink" title="命令行"></a>命令行</h4><p><u><a target="_blank" rel="noopener" href="https://www.geomesa.org/documentation/user/cli/index.html">Command-Line Tools</a></u></p>
</li>
<li><h4 id="底层存储"><a href="#底层存储" class="headerlink" title="底层存储"></a>底层存储</h4><ul>
<li><a target="_blank" rel="noopener" href="https://www.geomesa.org/documentation/user/hbase/index.html">HBase Data Store</a></li>
<li><a target="_blank" rel="noopener" href="https://www.geomesa.org/documentation/user/accumulo/index.html">Accumulo Data Store</a></li>
<li><a target="_blank" rel="noopener" href="https://www.geomesa.org/documentation/user/bigtable/index.html">Bigtable Data Store</a></li>
<li><a target="_blank" rel="noopener" href="https://www.geomesa.org/documentation/user/cassandra/index.html">Cassandra Data Store</a></li>
<li><a target="_blank" rel="noopener" href="https://www.geomesa.org/documentation/user/kafka/index.html">Kafka Data Store</a></li>
<li><a target="_blank" rel="noopener" href="https://www.geomesa.org/documentation/user/redis/index.html">Redis Data Store</a></li>
<li><a target="_blank" rel="noopener" href="https://www.geomesa.org/documentation/user/filesystem/index.html">FileSystem Data Store</a></li>
<li><a target="_blank" rel="noopener" href="https://www.geomesa.org/documentation/user/kudu/index.html">Kudu Data Store</a></li>
<li><a target="_blank" rel="noopener" href="https://www.geomesa.org/documentation/user/lambda/index.html">Lambda Data Store</a></li>
</ul>
</li>
</ul>
<h3 id="2：时空索引-R树"><a href="#2：时空索引-R树" class="headerlink" title="2：时空索引-R树"></a>2：时空索引-R树</h3><ul>
<li>据R树的这种数据结构，当我们需要进行一个高维空间查询时，我们只需要遍历少数几个叶子结点所包含的指针，查看这些指针指向的数据是否满足要求即可。</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20210429142905968.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2E3NzIzMDQ0MTk=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<ul>
<li><p>Oracle Spatial、MySQL Spatial、PostgreSQL(PostGIS) 都是基于R树进行空 间搜索操作，即对空间字段(Geometry Column)创建R树索引。</p>
</li>
<li><p>R树存在的问题:</p>
<ol>
<li>单独创建索引⽂文件 </li>
<li>数据更更新问题：为了了达到平衡状态，新插⼊入数据需要更更新整个R树 。</li>
<li>不不适合NoSQL的结构<br>HBase本身只提供基于⾏行行键和全表扫描的查询，⽽而⾏行行键索引单⼀一，对于多维度的查询困难。</li>
</ol>
</li>
</ul>
<h3 id="3：GeoHash"><a href="#3：GeoHash" class="headerlink" title="3：GeoHash"></a>3：GeoHash</h3><h4 id="1简介"><a href="#1简介" class="headerlink" title="1简介"></a>1简介</h4><p> GeoHash是一种地址编码方法。他能够把二维的空间经纬度数据编码成一个字符串。GeoHash具有以下特点：<br>1、GeoHash用一个字符串表示经度和纬度两个坐标。在数据库中可以实现在一列上应用索引<br>2、GeoHash表示的并不是一个点，而是一个区域；<br>3、GeoHash编码的前缀可以表示更大的区域。例如wx4g0ec1，它的前缀wx4g0e表示包含编码wx4g0ec1在内的更大范围。 这个特性可以用于附近地点搜索 。</p>
<h4 id="2：GeoHash的计算过程："><a href="#2：GeoHash的计算过程：" class="headerlink" title="2：GeoHash的计算过程："></a>2：GeoHash的计算过程：</h4><h5 id="1-将经纬度转换成二进制："><a href="#1-将经纬度转换成二进制：" class="headerlink" title="1.将经纬度转换成二进制："></a>1.将经纬度转换成二进制：</h5><p>比如这样一个点（39.923201, 116.390705） 纬度的范围是（-90，90），其中间值为0。对于纬度39.923201，在区间（0，90）中，因此得到一个1；（0，90）区间的中间值为45度，纬度39.923201小于45，因此得到一个0，依次计算下去，即可得到纬度的二进制表示。</p>
<p><img src="https://img-blog.csdnimg.cn/20210429142932930.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2E3NzIzMDQ0MTk=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p> 最后得到纬度的二进制表示为： 10111000110001111001<br>同理可以得到经度116.390705的二进制表示为： 11010010110001000100 </p>
<h5 id="2-合并纬度、经度的二进制："><a href="#2-合并纬度、经度的二进制：" class="headerlink" title="2.合并纬度、经度的二进制："></a>2.合并纬度、经度的二进制：</h5><p>合并方法是将经度、纬度二进制按照奇偶位合并： 1110011101001000111100000011010101100001 </p>
<p>如下图：</p>
<p><img src="https://img-blog.csdnimg.cn/20210429142955755.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2E3NzIzMDQ0MTk=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h5 id="3：按照Base32进行编码："><a href="#3：按照Base32进行编码：" class="headerlink" title="3：按照Base32进行编码："></a>3：按照Base32进行编码：</h5><p>Base32编码表（其中一种）：</p>
<p><img src="https://img-blog.csdnimg.cn/20210429143013515.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2E3NzIzMDQ0MTk=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p> 将上述合并后二进制编码后结果为： wx4g0ec1</p>
<h4 id="3：特点："><a href="#3：特点：" class="headerlink" title="3：特点："></a>3：特点：</h4><ul>
<li><input checked="" disabled="" type="checkbox"> 字符串越长，表示的范围越小越精确;字符串长度越小，表示的范围越大越宽泛。</li>
<li><input checked="" disabled="" type="checkbox"> 字符串越相似表示距离越相近。</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20210429143034295.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2E3NzIzMDQ0MTk=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h3 id="4：GeoMesa时空索引"><a href="#4：GeoMesa时空索引" class="headerlink" title="4：GeoMesa时空索引"></a>4：GeoMesa时空索引</h3><h4 id="1：各种空间填充曲线"><a href="#1：各种空间填充曲线" class="headerlink" title="1：各种空间填充曲线"></a>1：各种空间填充曲线</h4><p><img src="https://img-blog.csdnimg.cn/20210429143054818.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2E3NzIzMDQ0MTk=,size_16,color_FFFFFF,t_70" alt="fill-line.png"></p>
<h4 id="2：空间查询"><a href="#2：空间查询" class="headerlink" title="2：空间查询"></a>2：空间查询</h4><ol>
<li>  用户定义查询窗口</li>
<li>  层次划分</li>
<li>  计算查询范围(Range)</li>
</ol>
<p><img src="https://img-blog.csdnimg.cn/20210429143118768.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2E3NzIzMDQ0MTk=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h4 id="3：GeoMesa时空索引"><a href="#3：GeoMesa时空索引" class="headerlink" title="3：GeoMesa时空索引"></a>3：GeoMesa时空索引</h4><p> GeoMesa使用了基于Z-order填充曲线的GeoHash空间索引技术，<br> 并针对时间维度进行了扩展，具体分为:<br>•  Z2:空间，点索引<br>•  Z3:时间+空间，点索引<br>•  XZ2:空间，线\面索引<br>•  XZ3:时间+空间，线\面索引。</p>
<p><img src="https://img-blog.csdnimg.cn/20210429143145356.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2E3NzIzMDQ0MTk=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>git实现：<a target="_blank" rel="noopener" href="https://github.com/locationtech/sfcurve">https://github.com/locationtech/sfcurve</a></p>
<p>​            <a target="_blank" rel="noopener" href="https://github.com/locationtech/geomesa/tree/master/geomesa-z3">https://github.com/locationtech/geomesa/tree/master/geomesa-z3</a></p>
<h3 id="5：GeoMesa-HBase-索引"><a href="#5：GeoMesa-HBase-索引" class="headerlink" title="5：GeoMesa HBase 索引"></a>5：GeoMesa HBase 索引</h3><ol>
<li>RowKey设计</li>
</ol>
<p><img src="https://img-blog.csdnimg.cn/20210429143210289.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2E3NzIzMDQ0MTk=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<ul>
<li><p> 属性索引<br><img src="https://img-blog.csdnimg.cn/20210429143243429.png" alt="在这里插入图片描述"></p>
</li>
<li><p> Z-Index Shards: 预拆分，范围为1-127，默认为4。<br><img src="https://img-blog.csdnimg.cn/20210429143306687.png" alt="在这里插入图片描述"></p>
</li>
<li><p> Z-Index Time Interval<br><img src="https://img-blog.csdnimg.cn/2021042914332713.png" alt="在这里插入图片描述"></p>
</li>
</ul>
<ol start="2">
<li><p>查询：</p>
<ul>
<li>可以按照属性查询</li>
<li>可以按照空间范围查询</li>
<li>可以按照时间查询</li>
<li>Geomesa会综合选择一种最快的查询方式执行</li>
</ul>
</li>
</ol>
<p><img src="https://img-blog.csdnimg.cn/20210429143342407.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2E3NzIzMDQ0MTk=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h2 id="第三部分：GeoMesa-数据存储"><a href="#第三部分：GeoMesa-数据存储" class="headerlink" title="第三部分：GeoMesa 数据存储"></a>第三部分：GeoMesa 数据存储</h2><h3 id="1：数据结构"><a href="#1：数据结构" class="headerlink" title="1：数据结构"></a>1：数据结构</h3><p><strong>SimpleFeatureType</strong>：空间数据结构描述，包含空间WKT、时间信息、属性信息等。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.locationtech.geomesa.utils.interop.SimpleFeatureTypes;</span><br><span class="line">SimpleFeatureTypes.createType(<span class="string">&quot;example&quot;</span>, <span class="string">&quot;name:String,dtg:Date,*geom:Point:srid=4326&quot;</span>);</span><br></pre></td></tr></table></figure>

<p><strong>属性类型</strong></p>
<table>
<thead>
<tr>
<th>Attribute Type</th>
<th>Binding</th>
<th>Indexable</th>
</tr>
</thead>
<tbody><tr>
<td>String</td>
<td>java.lang.String</td>
<td>Yes</td>
</tr>
<tr>
<td>Integer</td>
<td>java.lang.Integer</td>
<td>Yes</td>
</tr>
<tr>
<td>Double</td>
<td>java.lang.Double</td>
<td>Yes</td>
</tr>
<tr>
<td>Long</td>
<td>java.lang.Long</td>
<td>Yes</td>
</tr>
<tr>
<td>Float</td>
<td>java.lang.Float</td>
<td>Yes</td>
</tr>
<tr>
<td>Boolean</td>
<td>java.lang.Boolean</td>
<td>Yes</td>
</tr>
<tr>
<td>UUID</td>
<td>java.util.UUID</td>
<td>Yes</td>
</tr>
<tr>
<td>Date</td>
<td>java.util.Date</td>
<td>Yes</td>
</tr>
<tr>
<td>Timestamp</td>
<td>java.sql.Timestamp</td>
<td>Yes</td>
</tr>
<tr>
<td>Point</td>
<td>org.locationtech.jts.geom.Point</td>
<td>Yes</td>
</tr>
<tr>
<td>LineString</td>
<td>org.locationtech.jts.geom.LineString</td>
<td>Yes</td>
</tr>
<tr>
<td>Polygon</td>
<td>org.locationtech.jts.geom.Polygon</td>
<td>Yes</td>
</tr>
<tr>
<td>MultiPoint</td>
<td>org.locationtech.jts.geom.MultiPoint</td>
<td>Yes</td>
</tr>
<tr>
<td>MultiLineString</td>
<td>org.locationtech.jts.geom.MultiLineString</td>
<td>Yes</td>
</tr>
<tr>
<td>MultiPolygon</td>
<td>org.locationtech.jts.geom.MultiPolygon</td>
<td>Yes</td>
</tr>
<tr>
<td>GeometryCollection</td>
<td>org.locationtech.jts.geom.GeometryCollection</td>
<td>Yes</td>
</tr>
<tr>
<td>Geometry</td>
<td>org.locationtech.jts.geom.Geometry</td>
<td>Yes</td>
</tr>
<tr>
<td>List[A]</td>
<td>java.util.List<A></td>
<td>Yes</td>
</tr>
<tr>
<td>Map[A,B]</td>
<td>java.util.Map&lt;A, B&gt;</td>
<td>No</td>
</tr>
<tr>
<td>Bytes</td>
<td>byte[]</td>
<td>No</td>
</tr>
</tbody></table>
<h2 id="第四部分：GeoMesa-Hbase应用"><a href="#第四部分：GeoMesa-Hbase应用" class="headerlink" title="第四部分：GeoMesa Hbase应用"></a>第四部分：GeoMesa Hbase应用</h2><h3 id="1：Geomesa-Hbase操作"><a href="#1：Geomesa-Hbase操作" class="headerlink" title="1：Geomesa Hbase操作"></a>1：Geomesa Hbase操作</h3><h3 id="2：GeoServer集合-Geomesa"><a href="#2：GeoServer集合-Geomesa" class="headerlink" title="2：GeoServer集合 Geomesa"></a>2：GeoServer集合 Geomesa</h3><p>Geomesa实现了GeoTools接口，提供了基于HTTP，方法和标准OGC服务的访问形式。</p>
<ul>
<li><p><a target="_blank" rel="noopener" href="http://www.opengeospatial.org/standards/wfs">Web Feature Service (WFS)</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="http://www.opengeospatial.org/standards/wms">Web Mapping Service (WMS)</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="http://www.opengeospatial.org/standards/wps">Web Processing Service (WPS)</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="http://www.opengeospatial.org/standards/wcs">Web Coverage Service (WCS)</a></p>
<h5 id="数据更新流程"><a href="#数据更新流程" class="headerlink" title="数据更新流程"></a>数据更新流程</h5></li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20210429143402258.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2E3NzIzMDQ0MTk=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h5 id="数据查询流程"><a href="#数据查询流程" class="headerlink" title="数据查询流程"></a>数据查询流程</h5><p><img src="https://img-blog.csdnimg.cn/20210429143414932.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2E3NzIzMDQ0MTk=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h2 id="第五部分：Geomesa-Spark"><a href="#第五部分：Geomesa-Spark" class="headerlink" title="第五部分：Geomesa Spark"></a>第五部分：Geomesa Spark</h2><p><img src="https://img-blog.csdnimg.cn/20210429143428566.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2E3NzIzMDQ0MTk=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h3 id="1：geomesa-spark-jts-：基于Spark-的JTS控件库。"><a href="#1：geomesa-spark-jts-：基于Spark-的JTS控件库。" class="headerlink" title="1：geomesa-spark-jts ：基于Spark 的JTS控件库。"></a>1：geomesa-spark-jts ：基于Spark 的JTS控件库。</h3><p><strong>依赖包</strong>：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.locationtech.geomesa<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>geomesa-spark-jts_2.11<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>从文件系统读取</strong></p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.locationtech.jts.geom._</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.types._</span><br><span class="line"><span class="keyword">import</span> org.locationtech.geomesa.spark.jts._</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> spark.implicits._</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> schema = <span class="type">StructType</span>(<span class="type">Array</span>(</span><br><span class="line">  <span class="type">StructField</span>(<span class="string">&quot;name&quot;</span>,<span class="type">StringType</span>, nullable=<span class="literal">false</span>),</span><br><span class="line">  <span class="type">StructField</span>(<span class="string">&quot;pointText&quot;</span>, <span class="type">StringType</span>, nullable=<span class="literal">false</span>),</span><br><span class="line">  <span class="type">StructField</span>(<span class="string">&quot;polygonText&quot;</span>, <span class="type">StringType</span>, nullable=<span class="literal">false</span>),</span><br><span class="line">  <span class="type">StructField</span>(<span class="string">&quot;latitude&quot;</span>, <span class="type">DoubleType</span>, nullable=<span class="literal">false</span>),</span><br><span class="line">  <span class="type">StructField</span>(<span class="string">&quot;longitude&quot;</span>, <span class="type">DoubleType</span>, nullable=<span class="literal">false</span>)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> dataFile = <span class="keyword">this</span>.getClass.getClassLoader.getResource(<span class="string">&quot;jts-example.csv&quot;</span>).getPath</span><br><span class="line"><span class="keyword">val</span> df = spark.read</span><br><span class="line">  .schema(schema)</span><br><span class="line">  .option(<span class="string">&quot;sep&quot;</span>, <span class="string">&quot;-&quot;</span>)</span><br><span class="line">  .option(<span class="string">&quot;timestampFormat&quot;</span>, <span class="string">&quot;yyyy/MM/dd HH:mm:ss ZZ&quot;</span>)</span><br><span class="line">  .csv(dataFile)</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> alteredDF = df</span><br><span class="line">  .withColumn(<span class="string">&quot;polygon&quot;</span>, st_polygonFromText($<span class="string">&quot;polygonText&quot;</span>))</span><br><span class="line">  .withColumn(<span class="string">&quot;point&quot;</span>, st_makePoint($<span class="string">&quot;latitude&quot;</span>, $<span class="string">&quot;longitude&quot;</span>))</span><br></pre></td></tr></table></figure>

<p><strong>构造df</strong></p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> spark.implicits._</span><br><span class="line"><span class="keyword">val</span> point = <span class="keyword">new</span> <span class="type">GeometryFactory</span>().createPoint(<span class="keyword">new</span> <span class="type">Coordinate</span>(<span class="number">3.4</span>, <span class="number">5.6</span>))</span><br><span class="line"><span class="keyword">val</span> df = <span class="type">Seq</span>(point).toDF(<span class="string">&quot;point&quot;</span>)</span><br></pre></td></tr></table></figure>



<h3 id="2：geomesa-spark-core：基于Geotools实现的Spark核心库，将空间数据转换为RDD。"><a href="#2：geomesa-spark-core：基于Geotools实现的Spark核心库，将空间数据转换为RDD。" class="headerlink" title="2：geomesa-spark-core：基于Geotools实现的Spark核心库，将空间数据转换为RDD。"></a>2：geomesa-spark-core：基于Geotools实现的Spark核心库，将空间数据转换为RDD。</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// DataStore params to a hypothetical GeoMesa Accumulo table</span></span><br><span class="line">val dsParams = Map(</span><br><span class="line">  <span class="string">&quot;accumulo.instance.id&quot;</span>   -&gt; <span class="string">&quot;instance&quot;</span>,</span><br><span class="line">  <span class="string">&quot;accumulo.zookeepers&quot;</span>    -&gt; <span class="string">&quot;zoo1,zoo2,zoo3&quot;</span>,</span><br><span class="line">  <span class="string">&quot;accumulo.user&quot;</span>          -&gt; <span class="string">&quot;user&quot;</span>,</span><br><span class="line">  <span class="string">&quot;accumulo.password&quot;</span>      -&gt; <span class="string">&quot;*****&quot;</span>,</span><br><span class="line">  <span class="string">&quot;accumulo.catalog&quot;</span>       -&gt; <span class="string">&quot;geomesa_catalog&quot;</span>,</span><br><span class="line">  <span class="string">&quot;geomesa.security.auths&quot;</span> -&gt; <span class="string">&quot;USER,ADMIN&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// set SparkContext</span></span><br><span class="line">val conf = <span class="keyword">new</span> SparkConf().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;testSpark&quot;</span>)</span><br><span class="line">val sc = SparkContext.getOrCreate(conf)</span><br><span class="line"></span><br><span class="line"><span class="comment">// create RDD with a geospatial query using GeoMesa functions</span></span><br><span class="line">val spatialRDDProvider = GeoMesaSpark(dsParams)</span><br><span class="line">val filter = ECQL.toFilter(<span class="string">&quot;CONTAINS(POLYGON((0 0, 0 90, 90 90, 90 0, 0 0)), geom)&quot;</span>)</span><br><span class="line">val query = <span class="keyword">new</span> Query(<span class="string">&quot;chicago&quot;</span>, filter)</span><br><span class="line">val resultRDD = spatialRDDProvider.rdd(<span class="keyword">new</span> Configuration, sc, dsParams, query)</span><br><span class="line"></span><br><span class="line">resultRDD.collect</span><br><span class="line"><span class="comment">// Array[org.opengis.feature.simple.SimpleFeature] = Array(</span></span><br><span class="line"><span class="comment">//    ScalaSimpleFeature:4, ScalaSimpleFeature:5, ScalaSimpleFeature:6,</span></span><br><span class="line"><span class="comment">//    ScalaSimpleFeature:7, ScalaSimpleFeature:9)</span></span><br></pre></td></tr></table></figure>

<p>包括SimpleFeatures、 Multiple backends （Accumulo, HBase, FileSystem, Kudu, <a target="_blank" rel="noopener" href="https://www.geomesa.org/documentation/user/convert/index.html#converters">GeoMesa Convert</a> library转换后文件系统, 其他 GeoTools 数据源）</p>
<h3 id="3：geomesa-spark-sql：基于SparkSQl-的空间查询库"><a href="#3：geomesa-spark-sql：基于SparkSQl-的空间查询库" class="headerlink" title="3：geomesa-spark-sql：基于SparkSQl 的空间查询库"></a>3：geomesa-spark-sql：基于SparkSQl 的空间查询库</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// DataStore params to a hypothetical GeoMesa Accumulo table</span></span><br><span class="line">val dsParams = Map(</span><br><span class="line">  <span class="string">&quot;accumulo.instance.id&quot;</span>   -&gt; <span class="string">&quot;instance&quot;</span>,</span><br><span class="line">  <span class="string">&quot;accumulo.zookeepers&quot;</span>    -&gt; <span class="string">&quot;zoo1,zoo2,zoo3&quot;</span>,</span><br><span class="line">  <span class="string">&quot;accumulo.user&quot;</span>          -&gt; <span class="string">&quot;user&quot;</span>,</span><br><span class="line">  <span class="string">&quot;accumulo.password&quot;</span>      -&gt; <span class="string">&quot;*****&quot;</span>,</span><br><span class="line">  <span class="string">&quot;accumulo.catalog&quot;</span>       -&gt; <span class="string">&quot;geomesa_catalog&quot;</span>,</span><br><span class="line">  <span class="string">&quot;geomesa.security.auths&quot;</span> -&gt; <span class="string">&quot;USER,ADMIN&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Create SparkSession</span></span><br><span class="line">val sparkSession = SparkSession.builder()</span><br><span class="line">  .appName(<span class="string">&quot;testSpark&quot;</span>)</span><br><span class="line">  .config(<span class="string">&quot;spark.sql.crossJoin.enabled&quot;</span>, <span class="string">&quot;true&quot;</span>)</span><br><span class="line">  .master(<span class="string">&quot;local[*]&quot;</span>)</span><br><span class="line">  .getOrCreate()</span><br><span class="line"></span><br><span class="line"><span class="comment">// Create DataFrame using the &quot;geomesa&quot; format</span></span><br><span class="line">val dataFrame = sparkSession.read</span><br><span class="line">  .format(<span class="string">&quot;geomesa&quot;</span>)</span><br><span class="line">  .options(dsParams)</span><br><span class="line">  .option(<span class="string">&quot;geomesa.feature&quot;</span>, <span class="string">&quot;chicago&quot;</span>)</span><br><span class="line">  .load()</span><br><span class="line">dataFrame.createOrReplaceTempView(<span class="string">&quot;chicago&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Query against the &quot;chicago&quot; schema</span></span><br><span class="line">val sqlQuery = <span class="string">&quot;select * from chicago where st_contains(st_makeBBOX(0.0, 0.0, 90.0, 90.0), geom)&quot;</span></span><br><span class="line">val resultDataFrame = sparkSession.sql(sqlQuery)</span><br><span class="line"></span><br><span class="line">resultDataFrame.show</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">+-------+------+-----------+--------------------+-----------------+</span></span><br><span class="line"><span class="comment">|__fid__|arrest|case_number|                 dtg|             geom|</span></span><br><span class="line"><span class="comment">+-------+------+-----------+--------------------+-----------------+</span></span><br><span class="line"><span class="comment">|      4|  true|          4|2016-01-04 00:00:...|POINT (76.5 38.5)|</span></span><br><span class="line"><span class="comment">|      5|  true|          5|2016-01-05 00:00:...|    POINT (77 38)|</span></span><br><span class="line"><span class="comment">|      6|  true|          6|2016-01-06 00:00:...|    POINT (78 39)|</span></span><br><span class="line"><span class="comment">|      7|  true|          7|2016-01-07 00:00:...|    POINT (20 20)|</span></span><br><span class="line"><span class="comment">|      9|  true|          9|2016-01-09 00:00:...|    POINT (50 50)|</span></span><br><span class="line"><span class="comment">+-------+------+-----------+--------------------+-----------------+</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>



<h2 id="第六部分：Cassandra应用"><a href="#第六部分：Cassandra应用" class="headerlink" title="第六部分：Cassandra应用"></a>第六部分：Cassandra应用</h2><p>1：Cassandra config</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">spring.data.cassandra.cluster-name&#x3D;Test Cluster</span><br><span class="line">spring.data.cassandra.keyspace-name&#x3D; user_space</span><br><span class="line">spring.data.cassandra.contact-points&#x3D;127.0.0.1</span><br><span class="line">spring.data.cassandra.port&#x3D;9042</span><br></pre></td></tr></table></figure>

<p>2：run test</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -cp geomesa-tutorials-cassandra&#x2F;geomesa-tutorials-cassandra-quickstart&#x2F;target&#x2F;geomesa-tutorials-cassandra-quickstart-2.4.0-SNAPSHOT.jar org.geomesa.example.cassandra.CassandraQuickStart --cassandra.contact.point 127.0.0.1:9042 --cassandra.keyspace geomesa --cassandra.catalog sample_table </span><br></pre></td></tr></table></figure>

<p>3：output        </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin&#x2F;geomesa-cassandra export --output-format leaflet --contact-point 127.0.0.1:9042 --key-space geomesa --catalog sample_table</span><br></pre></td></tr></table></figure>



<h2 id="第七部分：其他应用"><a href="#第七部分：其他应用" class="headerlink" title="第七部分：其他应用"></a>第七部分：其他应用</h2><h3 id="1：GeoMesa-Kafka-DataStore"><a href="#1：GeoMesa-Kafka-DataStore" class="headerlink" title="1：GeoMesa Kafka DataStore"></a>1：GeoMesa Kafka DataStore</h3><p>• 使⽤用Kafka作为数据存储DataStore<br>• 通过GeoTools DataStore标准接⼝口进⾏行行访问</p>
<p>• Consumer与Producer可以分布在不不同server</p>
<p>• ⽀支持要素缓存，定时写⼊入kafka</p>
<h3 id="2：GeoMesa-Lambda-DataStore"><a href="#2：GeoMesa-Lambda-DataStore" class="headerlink" title="2：GeoMesa Lambda DataStore"></a>2：GeoMesa Lambda DataStore</h3><ul>
<li><p>数据存储在两个层:transienttier(Kafka)和 a persistent tier(HBase)</p>
</li>
<li><p>数据定时写⼊持久层</p>
</li>
<li><p>使⽤用ZK同步数据缓存状态，保证数据一次写⼊</p>
</li>
<li><p>进⾏行行数据查询会从两个存储层分别进⾏， 然后合并查询结果返回给⽤用户。</p>
</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20210429143458982.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2E3NzIzMDQ0MTk=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
  </article>
  <aside class="table-content" id="site-toc">
  <div class="table-content-title">
    <i class="fa fa-arrow-right fa-lg" id="site-toc-hide-btn"></i>
    <span>目录</span>
  </div>
  <div class="table-content-main">
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#GeoMesa-%E7%A9%BA%E9%97%B4%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E"><span class="toc-text">GeoMesa-空间数据存储引擎</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86%EF%BC%9AGeoMesa%E7%AE%80%E4%BB%8B"><span class="toc-text">第一部分：GeoMesa简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86%EF%BC%9AGeoMesa%E6%9E%B6%E6%9E%84%E4%BD%93%E7%B3%BB"><span class="toc-text">第二部分：GeoMesa架构体系</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%EF%BC%9A%E6%A8%A1%E5%9D%97%E5%88%92%E5%88%86"><span class="toc-text">1：模块划分</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%A5%E5%8F%A3%E5%B1%82"><span class="toc-text">接口层</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E8%A1%8C"><span class="toc-text">命令行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BA%95%E5%B1%82%E5%AD%98%E5%82%A8"><span class="toc-text">底层存储</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%EF%BC%9A%E6%97%B6%E7%A9%BA%E7%B4%A2%E5%BC%95-R%E6%A0%91"><span class="toc-text">2：时空索引-R树</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%EF%BC%9AGeoHash"><span class="toc-text">3：GeoHash</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E7%AE%80%E4%BB%8B"><span class="toc-text">1简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%EF%BC%9AGeoHash%E7%9A%84%E8%AE%A1%E7%AE%97%E8%BF%87%E7%A8%8B%EF%BC%9A"><span class="toc-text">2：GeoHash的计算过程：</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E5%B0%86%E7%BB%8F%E7%BA%AC%E5%BA%A6%E8%BD%AC%E6%8D%A2%E6%88%90%E4%BA%8C%E8%BF%9B%E5%88%B6%EF%BC%9A"><span class="toc-text">1.将经纬度转换成二进制：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E5%90%88%E5%B9%B6%E7%BA%AC%E5%BA%A6%E3%80%81%E7%BB%8F%E5%BA%A6%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%EF%BC%9A"><span class="toc-text">2.合并纬度、经度的二进制：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%EF%BC%9A%E6%8C%89%E7%85%A7Base32%E8%BF%9B%E8%A1%8C%E7%BC%96%E7%A0%81%EF%BC%9A"><span class="toc-text">3：按照Base32进行编码：</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%EF%BC%9A%E7%89%B9%E7%82%B9%EF%BC%9A"><span class="toc-text">3：特点：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%EF%BC%9AGeoMesa%E6%97%B6%E7%A9%BA%E7%B4%A2%E5%BC%95"><span class="toc-text">4：GeoMesa时空索引</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%EF%BC%9A%E5%90%84%E7%A7%8D%E7%A9%BA%E9%97%B4%E5%A1%AB%E5%85%85%E6%9B%B2%E7%BA%BF"><span class="toc-text">1：各种空间填充曲线</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%EF%BC%9A%E7%A9%BA%E9%97%B4%E6%9F%A5%E8%AF%A2"><span class="toc-text">2：空间查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%EF%BC%9AGeoMesa%E6%97%B6%E7%A9%BA%E7%B4%A2%E5%BC%95"><span class="toc-text">3：GeoMesa时空索引</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%EF%BC%9AGeoMesa-HBase-%E7%B4%A2%E5%BC%95"><span class="toc-text">5：GeoMesa HBase 索引</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E9%83%A8%E5%88%86%EF%BC%9AGeoMesa-%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8"><span class="toc-text">第三部分：GeoMesa 数据存储</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%EF%BC%9A%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-text">1：数据结构</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E9%83%A8%E5%88%86%EF%BC%9AGeoMesa-Hbase%E5%BA%94%E7%94%A8"><span class="toc-text">第四部分：GeoMesa Hbase应用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%EF%BC%9AGeomesa-Hbase%E6%93%8D%E4%BD%9C"><span class="toc-text">1：Geomesa Hbase操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%EF%BC%9AGeoServer%E9%9B%86%E5%90%88-Geomesa"><span class="toc-text">2：GeoServer集合 Geomesa</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%9B%B4%E6%96%B0%E6%B5%81%E7%A8%8B"><span class="toc-text">数据更新流程</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E6%B5%81%E7%A8%8B"><span class="toc-text">数据查询流程</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%94%E9%83%A8%E5%88%86%EF%BC%9AGeomesa-Spark"><span class="toc-text">第五部分：Geomesa Spark</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%EF%BC%9Ageomesa-spark-jts-%EF%BC%9A%E5%9F%BA%E4%BA%8ESpark-%E7%9A%84JTS%E6%8E%A7%E4%BB%B6%E5%BA%93%E3%80%82"><span class="toc-text">1：geomesa-spark-jts ：基于Spark 的JTS控件库。</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%EF%BC%9Ageomesa-spark-core%EF%BC%9A%E5%9F%BA%E4%BA%8EGeotools%E5%AE%9E%E7%8E%B0%E7%9A%84Spark%E6%A0%B8%E5%BF%83%E5%BA%93%EF%BC%8C%E5%B0%86%E7%A9%BA%E9%97%B4%E6%95%B0%E6%8D%AE%E8%BD%AC%E6%8D%A2%E4%B8%BARDD%E3%80%82"><span class="toc-text">2：geomesa-spark-core：基于Geotools实现的Spark核心库，将空间数据转换为RDD。</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%EF%BC%9Ageomesa-spark-sql%EF%BC%9A%E5%9F%BA%E4%BA%8ESparkSQl-%E7%9A%84%E7%A9%BA%E9%97%B4%E6%9F%A5%E8%AF%A2%E5%BA%93"><span class="toc-text">3：geomesa-spark-sql：基于SparkSQl 的空间查询库</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%85%AD%E9%83%A8%E5%88%86%EF%BC%9ACassandra%E5%BA%94%E7%94%A8"><span class="toc-text">第六部分：Cassandra应用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%83%E9%83%A8%E5%88%86%EF%BC%9A%E5%85%B6%E4%BB%96%E5%BA%94%E7%94%A8"><span class="toc-text">第七部分：其他应用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%EF%BC%9AGeoMesa-Kafka-DataStore"><span class="toc-text">1：GeoMesa Kafka DataStore</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%EF%BC%9AGeoMesa-Lambda-DataStore"><span class="toc-text">2：GeoMesa Lambda DataStore</span></a></li></ol></li></ol></li></ol>
  </div>
</aside>
  
    <aside class="passage-copyright">
      <div>本文作者: 张学亮</div>
      
        <div>
          原文链接: 
          <a href="" target="_blank">http://xueliang666.github.com/2021/04/24/GeoMesa-%E7%A9%BA%E9%97%B4%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/</a>
        </div>
      
      <div>
        版权声明: 本博客所有文章除特别声明外, 均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议. 转载请注明出处!
      </div>
    </aside>
  
  
    <div class="passage-tags">
     
      <a href="/tags/GeoMesa/"><i class="fa fa-tags"></i>GeoMesa</a>
    
    </div>
  
</div>

    </main>
    
    <div class="site-footer-wrapper">
  <footer class="site-footer">
    
    <div class="site-footer-info">
      <i class="fa fa-clock-o"></i> 本站已稳定运行<span id="site-time"></span>
    </div>
    
    
    <div class="site-footer-info">
      <i class="fa fa-copyright"></i> 
      2021 <a href="https://zhangxueliang.blog.csdn.net/" target="_blank">学亮编程手记</a>.
      Created by <a href="https://zhangxueliang.blog.csdn.net/" target="_blank">张学亮</a>.
      All rights reserved.
    </div>
  </footer>
</div>
    <div id="site-layer" style="display:none;">
  <div class="site-layer-content">
    <div class="site-layer-header">
      <span class="site-layer-header-title" id="site-layer-title"></span>
      <i class="fa fa-close" id="site-layer-close"></i>
    </div>
    <div class="site-layer-body" id="site-layer-container">
      <div class="site-layer-input" id="site-layer-search" style="display: none;">
        <div class="site-layer-input-choose">
          <a href="javascript:void(0);" title="Change Search Engine">Google</a>
        </div>
        <input type="text">
        <i class="fa fa-search"></i>
      </div>
      
      <div id="site-layer-welcome" style="display:none;"></div>
    </div>
  </div>
</div>
    

<div class="bottom-bar">
  <div class="bottom-bar-left">
    <a href="/2021/04/29/%EF%BC%88%E4%B8%80%EF%BC%89Geospark%E5%85%A5%E9%97%A8/" data-enable="true">
      <i class="fa fa-arrow-left"></i>
    </a>
    <a href="/2020/05/06/Java%E4%B8%AD%E7%9A%84SPI%E6%9C%BA%E5%88%B6/" data-enable="true">
      <i class="fa fa-arrow-right"></i>
    </a>
  </div>
  <div class="bottom-bar-right">
    <a href="javascript:void(0);" data-enable="true" id="site-toc-show-btn">
      <i class="fa fa-bars"></i>
    </a>
    
    <a href="javascript:void(0);" id="site-toggle-share-btn">
      <i class="fa fa-share-alt"></i>
    </a>
    
    <a href="javascript:void(0);" id="back-top-btn">
      <i class="fa fa-chevron-up"></i>
    </a>
  </div>
</div>
    <div id="share-btn">
  
    <a id="share-btn-twitter" href="javascript:void(0);" target="_blank">
      <i class="fa fa-twitter"></i>
    </a>
  
  
    <a id="share-btn-facebook" href="javascript:void(0);" target="_blank">
      <i class="fa fa-facebook"></i>
    </a>
  
  
    <a id="share-btn-weibo" href="javascript:void(0);" target="_blank">
      <i class="fa fa-weibo"></i>
    </a>
  
  
    <a id="share-btn-qq" href="javascript:void(0);" target="_blank">
      <i class="fa fa-qq"></i>
    </a>
  
  
    <a id="share-btn-wechat" href="javascript:void(0);" target="_blank">
      <i class="fa fa-wechat"></i>
    </a>
  
</div>
    





    
  </body>
</html>